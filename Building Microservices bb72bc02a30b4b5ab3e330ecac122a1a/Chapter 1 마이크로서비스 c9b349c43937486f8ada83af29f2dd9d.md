# Chapter 1. 마이크로서비스

# 마이크로 서비스

작고 자율적으로 협업하는 서비스를 의미한다. 아래와 같은 특성을 가진다

## 작고, 한 가지 일을 잘하는데 주력

- 단일책임원칙(Single Responsibility Principle) : '같은 이유로 변경되는 것들은 한데 모으고, 서로 다른 이유로 변경되는 것들은 분리하라.'
- 주어진 기능과 관련 코드들이 명확히 제자리에 있도록 하면서 서비스 경계를 비즈니스 경계에 일치시킴으로써 서비스가 지나치게 커지는 것을 회피한다.

## 자율성

- 각 서비스들은 서로 독립적으로 변경될 수 있어야 하고, API를 호출하는 클라이언트(다른 서비스 혹은 UI/UX 등등)를 변경할 필요 없이 독립적으로 배포 될 수 있어야 한다.
- **각 서비스간에 모든 통신은 네트워크 호출을 통해 이루어진다.**

# 장점

## 기술 이기종성

- 각 서비스가 다른 기술을 사용하도록 할 수 있다. 즉, 각 작업에 적합한 도구(라이브러리, 프레임워크 혹은 데이터베이스 등)를 선택할 수 있도록 해준다.

![Chapter%201%20%E1%84%86%E1%85%A1%E1%84%8B%E1%85%B5%E1%84%8F%E1%85%B3%E1%84%85%E1%85%A9%E1%84%89%E1%85%A5%E1%84%87%E1%85%B5%E1%84%89%E1%85%B3%20c9b349c43937486f8ada83af29f2dd9d/Untitled.png](Chapter%201%20%E1%84%86%E1%85%A1%E1%84%8B%E1%85%B5%E1%84%8F%E1%85%B3%E1%84%85%E1%85%A9%E1%84%89%E1%85%A5%E1%84%87%E1%85%B5%E1%84%89%E1%85%B3%20c9b349c43937486f8ada83af29f2dd9d/Untitled.png)

## 회복성

- 한 서비스의 컴포넌트에 장애가 발생하더라도 그 장애가 다른 서비스로 전파되지 않는다.
- 모놀리틱에서는 한 서비스가 장애가 발생하면 모든 것이 작동을 멈춘다.

## 확장성

- 특정 서비스만 퍼포먼스가 떨어지게 된다면, 그 서비스만 확장할 수 있다.
- 모놀리틱에서는 전체를 한 덩어리처럼 확장해야 한다.

## 배포 용이성

- 시스템의 여러 서비스 중 하나의 서비스만 변경할 수 있고, 나머지 시스템과 독립적으로 배포를 진행할 수 있다.
- 문제 발생시 해당 서비스만 롤백함으로써 문제 격리 가능
- 모놀리틱에서는 시스템의 모든 서비스를 한꺼번에 배포해야 한다.

## 조직 부합성

- 시스템의 아키텍처를 조직 구조에 맞게 적절히 정렬 할 수 있고 팀크기와 생산성을 위해 인원을 최소화 할 수 있다.

## 조합성

- 요구사항에 맞춰 다양한 방식으로 선택하고 조립하여 조합 할 수 있다. (웹, 네이티브 앱, 모바일 웹 등등 )
- 모놀리틱의 경우 외부에서 사용할 수 있는 하나의 큰 Endpoint를 가지고 있다.

## 대체 가능성을 위한 최적화

- 모놀로틱에 비해 더 나은 구현으로 교체하는 비용을 줄일 수 있고 삭제도 쉽게 할 수 있다.

# 서비스 지향 아키텍처(SOA : Service-Oriented Architecture)

- 서비스(완전히 분리된 운영시스템의 프로세스를 의미)의 최종 능력 집합을 제공하는 여러 서비스가 서로 협업하도록 하는 설계 접근 방식
- 서비스간 통신은 네트워크 호출로 이루어짐
- 서비스의 의미를 아주 많이 변경하지 않는 한 이론적으로 남들 모르게 서비스를 다른 서비스로 대체할 수 있어 유지보수와 재작성을 쉽게 한다.
- **마이크로서비스는 SOA에 대한 특정 접근법으로 보아야 한다.**

# 마이크로서비스와 유사한 분해 기술

## 공유 라이브러리

- 팀과 서비스 간에 기능을 공유하도록 함 (Ex : 유틸리티 혹은 재사용 가능한 정적 라이브러리)
- 서드파티에서 제공하거나 내부에서 만들수도 있음.
- 동일한 언어로 구현되거나 동일 플랫폼에서 실행됨. (기술 이기종성 확보 X)
- 시스템을 일부만 독립적으로 확장하기 어려움.(라이브러리를 참조하는 모든 서비스에 영향이 가므로, 확장성 확보 X)
- 라이브러리만 배포하기 어려움 (배포 용이성 확보 X)
- 구조적 안전조치를 취할 명확한 접합부 부족(회복성  확보 X)
- **일반적인 공통 업무를 위한 코드가 재사용되어야 할때 사용**

## 모듈

- 라이브러리보다 뛰어난 모듈 분해 기술
- 일부언어에서만 제공
- 일부 언어에서는 프로세스를 종료하지 않고도 실행중인 프로세스에 변경된 모듈을 배포할 수 있음.
- OSGI(Open Source Gateway Initiative), Erlang 가 대표적.

# 은탄환은 없다.

- 마이크로서비스가 만능은 결코 아니다.
- 마이크로서비스는 분산 시스템과 연관된 모든 종류의 복잡성을 내포하고 있다.
- 시스템을 확대하고 회복력을 유지하는 방법에 대해 많은 고려가 필요하다.
- **마이크로서비스가 적합한지, 적극적으로 활용할 수 있는지는 다양한 요인에 의해 결정됨.**